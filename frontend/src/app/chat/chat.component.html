<!-- Chat button (when closed) -->
<div *ngIf="!isOpen" class="chat-button" (click)="toggleChat()">
  <i class="fas fa-comments"></i>
</div>

<!-- Chat widget (when open) -->
<div *ngIf="isOpen" class="chat-widget">
  <div class="chat-header" (click)="toggleChat()">
    <h3>{{ 'CHAT.TITLE' | translate }}</h3>
    <button class="chat-toggle">
      <i class="fas fa-times"></i>
    </button>
  </div>

  <div class="chat-messages" #chatContainer>
    <!-- Loading indicator -->
    <div *ngIf="loading" class="loading-indicator">
      <div class="loading-spinner"></div>
    </div>

    <!-- Empty state -->
    <div *ngIf="!loading && messages.length === 0" class="empty-state">
      <i class="fas fa-comment-dots"></i>
      <p>{{ 'CHAT.WELCOME_MESSAGE' | translate }}</p>
    </div>

    <!-- Messages -->
    <div *ngFor="let message of messages"
         [ngClass]="{'message': true, 'user-message': !message.is_admin, 'admin-message': message.is_admin}">
      {{ message.message }}
      <div class="message-time">{{ formatTime(message.created_at) }}</div>
    </div>
  </div>

  <div class="chat-input">
    <input
      type="text"
      [(ngModel)]="newMessage"
      placeholder="{{ 'CHAT.INPUT_PLACEHOLDER' | translate }}"
      (keyup.enter)="sendMessage()"
    >
    <button [disabled]="!newMessage.trim()" (click)="sendMessage()">
      <i class="fas fa-paper-plane"></i>
    </button>
  </div>
</div>